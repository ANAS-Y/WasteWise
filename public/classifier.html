<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Waste Classifier</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.5.0/font/bootstrap-icons.css" rel="stylesheet">
    <link href="css/styles.css" rel="stylesheet">
    <link href="/css/styles.css" rel="stylesheet">
    <link href="/css/doubleNav.css" rel="stylesheet">
    <base href="/">
   
</head>
<body onloadeddata="loadUserName()">
<!-- Navigation Bar -->
<div id="nav-container"></div>

    <!-- Main Content -->
    <div class="content" >
        <h4 class="text-center text-success" style="font-weight: 800;">Waste Classifier</h4>
        <form id="uploadForm" class="form-group">
            <label for="images">Upload Images:</label>
            <input type="file" id="images" name="images" class="form-control-file" required>
            <button type="submit" class="btn btn-success mt-3" style="width: 40%; margin-left: 30%;">Classify</button>
        </form>
        <div id="results"></div>

          <!-- Footer Section -->
      <footer class="footer bg-light" style="width: 100%; margin: 0; margin-top: 15%;">
        <div class="">
            <div class="footer-bottom text-center">
                &copy; 2024 Waste Wise App. All rights reserved.
            </div>
        </div>
    </footer>
    </div>
    <script src="js/nav.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script>
      document.getElementById('uploadForm').addEventListener('submit', async function(event) {
        event.preventDefault();

        const fileInput = document.getElementById('images');
        const file = fileInput.files[0];
        if (!file) {
          alert('Please select a file.');
          return;
        }

        const formData = new FormData();
        formData.append('image', file);

        try {
          const response = await fetch('/api/classify', {
            method: 'POST',
            body: formData
          });

          if (!response.ok) {
            throw new Error('Error classifying image');
          }

          const result = await response.json();
          displayResults(result.predictions, result.category);
        } catch (error) {
          console.error(error);
          alert('Error classifying image');
        }
      });

      function displayResults(predictions, category) {
        const resultsDiv = document.getElementById('results');
        resultsDiv.innerHTML = `
          <div class="card">
            <div class="card-body">
              <h5 class="card-title mt-3">Categories of Objects:</h5>
              <h5 class=" Text-success card-title">The List of Recyclable Objects Found in the Watse materials are shown below:</h5>
              <ul class="list-group list-group-flush">
                
                ${predictions.map(p => `<li class="list-group-item">${p.label} </li>`).join('')}
              </ul>
              <h5 class="card-text text-danger">The List of ${category}  Found in the Watse materials are shown below:</h5>
            </div>
          </div>
        `;
      }
    </script>
    
    <script src="js/wastewise.js"></script>
    <script src="js/scripts.js"></script>
    <!-- Bootstrap JS, Popper.js, and jQuery -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    
</body>
</html>
